# Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

steps:
  - bash: |
      set -euo pipefail
      jq -nc >job-md.json '{
        agent_id: "$(Agent.Id)",
        agent_job_name: "$(Agent.JobName)",
        agent_machine_name: "$(Agent.MachineName)",
        agent_name: "$(Agent.Name)",
        agent_os: "$(Agent.OS)",
        agent_os_architecture: "$(Agent.OSArchitecture)",
        build_build_id: "$(Build.BuildId)",
        build_build_number: "$(Build.BuildNumber)",
        build_definition_name: "$(Build.DefinitionName)",
        build_source_branch: "$(Build.SourceBranch)",
        build_source_branch_name: "$(Build.SourceBranchName)",
        build_source_version: "$(Build.SourceVersion)",
        system_job_attempt: "$(System.JobAttempt)",
        system_job_display_name: "$(System.JobDisplayName)",
        system_job_id: "$(System.JobId)",
        system_job_name: "$(System.JobName)",
      }'
      jq <job-md.json .
